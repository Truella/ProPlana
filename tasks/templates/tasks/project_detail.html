{% extends 'base.html' %}
{% load static %}

{% block content %}
  <div class="min-h-screen bg-gray-50 p-6">
    <div class="md:w-[80vw] h-full m-auto md:flex md:gap-8 ">
      <!-- Project Info -->
      <div class="bg-white shadow-md rounded-xl p-6 mb-6 flex-1">
        <h2 class="text-2xl font-[500] text-blue-600 mb-2">{{ project.name }}</h2>
        <p class="text-gray-700 leading-relaxed mb-1">
          <span class="font-semibold">Project Description</span> <br>{{ project.description }}
        </p>
        <p class="mb-2">
          <span class="font-semibold">
            Status: 
          </span>
          {% if project.is_completed %}
              <span class="text-green-600">Completed</span>
            {% else %}
              In Progress
            {% endif %}
        </p>
        <p class="mb-2" >
          <span class="font-semibold">Pending tasks:</span> {{pending_count}}
        </p>
        <p class="mb-2" >
          <span class="font-semibold">Completed tasks:</span> {{completed_count}}
        </p>
        <p class="mb-2" >
          <span class="font-semibold">Due Date:</span> {{ project.due_date }}
        </p>
        
      </div>

      <!-- Task List -->
      <div class="bg-gray-50 shadow-sm rounded-xl p-6 flex-2">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-semibold text-gray-800">Tasks</h3>
          <a href="{% url 'create-task' project.pk %}" class="px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700">+ Add Task</a>
        </div>

        {% if project.tasks.all %}
          <ul class="divide-y divide-gray-200">
            {% for task in project.tasks.all %}
              <li class="flex items-center justify-between py-3">
                <div class="flex items-center space-x-3">
                  <!-- Checkbox -->
                  <form method="post" action="{% url 'toggle-task' task.id %}">
                    {% csrf_token %}
                    <input type="checkbox" name="is_completed" onchange="this.form.submit()" {% if task.is_completed %} checked {% endif %}/>
                  </form>

                  <!-- Task Info -->
                  <div>
                    <p class="text-gray-800 font-medium {% if task.completed %}line-through text-gray-400{% endif %}">{{ task.title }}</p>
                    <p class="text-sm text-gray-500">Due date: {{ task.due_date }}</p>
                  </div>
                </div>

                <!-- Actions -->
                <div class="flex space-x-6">
                  <a href="{% url 'edit-task' project.pk task.pk %}" class="text-green-600 hover:underline text-sm">Edit</a>
                  <a href="#" class="text-red-600 hover:underline text-sm">Delete</a>
                </div>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-gray-500 text-sm">No tasks yet. Add one above ðŸ‘†</p>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
